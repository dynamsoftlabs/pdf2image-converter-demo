/*! 20210427
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: http://www.dynamsoft.com
*
* Copyright 2021, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 17.1
*
* Module: addon/pdf
* final js: build\addon\dynamsoft.webtwain.addon.pdf.js
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{};Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[];Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(n){Dynamsoft.aryAddonReadyFun.push(n)},function(){for(var i=[Dynamsoft.DWT],n=0,t;n<1;n++)t=i[n],t.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3},t.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBig2:7}}(typeof window!="undefined"?window:this);Dynamsoft.AddonReady(function(n){if(n.product.bHTML5Edition){var t,i=function(i){var r=n.html5.Funs,u;t=n.env.bMac?Dynamsoft.dcp.b64bit?"libDynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dylib":n.env.bLinux?"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".so":Dynamsoft.dcp.b64bit?"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll";i._isMobileMode()||i._innerSend("GetAddOnVersion",r.makeParams("pdf",t),!0,!1,!1);u={PDF:{IsModuleInstalled:function(){var n=i,u;return(n._resetErr(),n._isMobileMode())?Dynamsoft.pdf?Dynamsoft.pdf.IsModuleInstalled():!1:(u=n._innerFun("GetAddOnVersion",r.makeParams("pdf",t)),u!="")},IsModuleInstalledAsync:function(){var u=i;return(u._resetErr(),u._isMobileMode())?Dynamsoft.pdf?n.Promise.resolve(Dynamsoft.pdf.IsModuleInstalled()):n.Promise.resolve(!1):u._innerFunV2("GetAddOnVersion",r.makeParams("pdf",t)).then(function(n){return n!=""})},ConvertToImage:function(n,t,u,f){var s=r.replaceLocalFilename(n),e="ConvertPDFToImage",h=function(){return r.hideMask(e),u&&u(),!0},c=function(){return r.hideMask(e),f&&f(),!1},o=i;return(o._resetErr(),o._isMobileMode())?!0:(r.showMask(e),o._innerSend(e,r.makeParams(s,t),!0,h,c),!0)},SetPassword:function(n){var t=i;return(t._resetErr(),t._isMobileMode())?(t._pdfPassword=n,!0):t._innerFun("SetPDFPassword",r.makeParams(n))},SetConvertMode:function(n){var t=i;return t._setConvertMode(n)},SetConvertModeAsync:function(n){var t=i;return t._setConvertModeAsync(n)},GetConvertMode:function(){var n=i;return n._resetErr(),n._pdfConvertMode},SetResolution:function(n){var t=i;return(t._resetErr(),t._isMobileMode())?(t._pdfResolution=1*n,!0):i._innerFun("SetPDFResolution",r.makeParams(n))},SetResolutionAsync:function(t){var u=i;return(u._resetErr(),u._isMobileMode())?(u._pdfResolution=1*t,n.Promise.resolve(!0)):i._innerFunV2("SetPDFResolution",r.makeParams(t))},IsTextBasedPDF:function(t,u,f){var e=i,s,o;return(e._resetErr(),e._isMobileMode())?e._mobileNotSupport("IsTextBasedPDF",f):(s=r.replaceLocalFilename(t),o=i._innerFun("IsTextBasedPDF",r.makeParams(s)),e.ErrorCode==0?n.isFunction(u)&&u(o):n.isFunction(f)&&f(e.ErrorCode,e.ErrorString),o)},Write:{Setup:function(t){var r=t,u,f;return(r||(r={version:15}),n.isNumber(r.version)?r.version>=1&&r.version<2&&(r.version=parseInt(10*r.version)):r.version=15,n.isNumber(r.compression)&&r.compression==Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(r.compression=Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),u=i,u._resetErr(),u._isMobileMode())?(u._pdfWriteSetting=r,!0):(f=n.stringify(r),f=n.replaceAll(f,'"','\\"'),u._innerFun("SetPDFSettings",['["',f,'"]'].join("")))}}}};i.__addon=i.__addon||{};n.mix(i.__addon,u)};n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(i)}});Dynamsoft.AddonReady(function(n){if(n.product.bPluginEdition||n.product.bActiveXEdition){var t=function(t){var r,i,u,f,e;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;Dynamsoft.navInfo.bWin&&(f=navigator.userAgent.toLowerCase(),e=!Dynamsoft.navInfo.bOSx64||f.indexOf("wow64")>=0,u=e?"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll");i=t.getSWebTwain();r={PDF:{IsModuleInstalled:function(){var r=i.GetAddOnVersion("pdf",u);return n.setErrorString(t),r!=""},IsModuleInstalledAsync:function(){var r=i.GetAddOnVersion("pdf",u);return n.setErrorString(t),n.Promise.resolve(r!="")},ConvertToImage:function(r,u,f,e){var o=i.ConvertPDFToImage(r,u);return n.wrapperRet(t,o,f,e)},SetPassword:function(r){var u=i.SetPDFPassword(r);return n.wrapperRet(t,u)},SetConvertMode:function(r){var u=r*1,f;return isNaN(u)?(n.Errors.ParameterCannotEmpty(t),!1):(u==0&&(u=Dynamsoft.DWT.EnumDWT_ConvertMode.CM_IMAGEONLY),u==Dynamsoft.DWT.EnumDWT_ConvertMode.CM_RENDERALL&&!n.License.checkProductKey(t,{PDFRasterizer:!0},!0))?!1:(f=i.SetPDFConvertMode(u),n.wrapperRet(t,f))},SetConvertModeAsync:function(n){return Promise.resolve(r.PDF.SetConvertMode(n))},GetConvertMode:function(){var r=i.GetPDFConvertMode();return n.wrapperRet(t,r)},SetResolution:function(r){var u=i.SetPDFResolution(r);return n.wrapperRet(t,u)},SetResolutionAsync:function(r){var u=i.SetPDFResolution(r);return n.Promise.resolve(n.wrapperRet(t,u))},IsTextBasedPDF:function(r){var u=i.IsTextBasedPDF(r);return n.wrapperRet(t,u)}}};t.Addon=t.Addon||{};n.mix(t.Addon,r)};n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(t)}});